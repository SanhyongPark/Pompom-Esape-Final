import{p as e}from"./vendor.a50a6e37.js";const t={title:"PomPom PK Farmer",type:e.AUTO,width:800,height:600,transparent:!0,disableContextMenu:!0,canvasStyle:"display: block; margin: 24px auto 0",physics:{default:"arcade",arcade:{debug:!1,debugShowBody:!0,debugShowStaticBody:!0,gravity:{x:0,y:0}}}};class s extends e.Scene{preload(){this.load.image("start-background","assets/start-background.png"),this.load.image("start-button","assets/start-button.png"),this.load.image("background","assets/background.png"),this.load.image("brownland","assets/brownland.png"),this.load.image("soil","assets/soil.png"),this.load.image("corn","assets/corn.png"),this.load.image("bar","assets/bar.png"),this.load.image("fence","assets/fence.png"),this.load.spritesheet("pompom","assets/pompom.png",{frameWidth:80,frameHeight:120}),this.load.spritesheet("farmer","assets/farmer.png",{frameWidth:84,frameHeight:98}),this.load.spritesheet("healthbar","assets/healthbar/healthbar.png",{frameWidth:160,frameHeight:80}),this.load.atlas("healthbar-json","assets/healthbar/healthbar.png","assets/healthbar/healthbar.json"),this.load.audio("background-music","assets/audio/background.ogg"),this.load.audio("alarm","assets/audio/alarm.wav"),this.load.audio("pick","assets/audio/pick.mp3"),this.load.audio("caught","assets/audio/caught.mp3"),this.load.audio("win","assets/audio/win.wav")}create(){this.scene.stop().start("Start")}}class r extends e.Scene{constructor(){super("Start")}create(){this.add.image(0,0,"start-background").setOrigin(0,0);const e=this.sound.add("background-music",{loop:!0});this.backgroundSound=e,e.play();const t=this.add.image(225,480,"start-button").setScale(.6);t.setInteractive(),t.input.cursor="pointer",t.on("pointerdown",(()=>{e.destroy(),this.scene.stop().start("LevelOne",{isPassed:!0})})),this.dispatchClick()}dispatchClick(){const e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});document.body.dispatchEvent(e)}}class a extends e.Scene{constructor(){super(...arguments),this.nextSceneName="LevelOne",this.currentLevel=1,this.pomSpeed=160,this.farmerSpeed=80,this.cornSoilGap=29,this.cornTotalCount=3,this.firstCornOffsetX=0,this.spaceKeyPressed=!1,this.currentCarryingCorn=null,this.currentCarryingIndex=-1,this.hasEnteredBrownland=!1,this.existingCornLists=[],this.eatenCornLists=[]}init(e={}){console.log(e,!1!==e.isPassed),this.loadMusicResource()}create(){const{scene:e,nextSceneName:t,eatenCornLists:s}=this;console.log(e.key,t,s),this.registerEvents(),this.drawBackgroundAndBrownland(),this.drawSoilAndCron(),this.drawFarmer(),this.drawPom(),this.drawHealthBar(),this.checkCollision()}update(){const{pom:t,farmer:s,cursor:r,scene:a,physics:n,spaceKeyPressed:o,currentCarryingIndex:i,hasEnteredBrownland:d,farmerSpeed:c,pomSpeed:h}=this;if(r.space.isDown){if(o)return;return this.spaceKeyPressed=!0,void(a.isPaused()?a.resume():a.pause())}if(r.up.isDown?(t.setVelocity(0,-h),t.anims.play("pompom-front",!0),this.drawCarryingCorn()):r.down.isDown?(t.setVelocity(0,h),t.anims.play("pompom-back",!0),this.drawCarryingCorn()):r.left.isDown?(t.setVelocity(-h,0),t.anims.play("pompom-left",!0),this.drawCarryingCorn()):r.right.isDown?(t.setVelocity(h,0),t.anims.play("pompom-right",!0),this.drawCarryingCorn()):(t.setVelocity(0,0),t.anims.pause()),~i||d){const r=e.Math.Angle.Between(t.x,t.y,s.x,s.y);let a="front";Math.abs(r)>3*Math.PI/4?a="right":Math.abs(r)<Math.PI/4?a="left":r>=Math.PI/4&&r<=3*Math.PI/4&&(a="back");const o=s.anims.play(`farmer-${a}`,!0);n.moveToObject(o,t,c)}}registerEvents(){const{input:{keyboard:e}}=this,t=e.createCursorKeys();this.cursor=t}drawBackgroundAndBrownland(){this.drawBackground(),this.drawBrownlandAndFence()}drawBackground(){const{physics:e}=this,{world:{bounds:{centerX:t,centerY:s}}}=e;this.add.image(t,s,"background")}drawBrownlandAndFence(){const{physics:e}=this,{world:{bounds:{width:t,centerX:s,centerY:r}}}=e,a=e.add.image(s,r+0,"brownland"),n=e.add.staticGroup();n.create(t-25,r+0,"fence").setOrigin(0,.5).refreshBody(),this.brownland=a,this.fenceGroup=n}drawSoilAndCron(){const{physics:e,cornTotalCount:t,cornSoilGap:s,eatenCornLists:r,firstCornOffsetX:a}=this,{world:{bounds:{centerY:n}}}=e,o=[];Array.from({length:t}).forEach(((t,i)=>{const d=150+a+s+(100+s)*i;if(this.add.image(d,n+0,"soil").setOrigin(0,.5),~r.indexOf(i))return;const c=e.add.image(d+45,n+0,"corn").setOrigin(0,.5).setScale(.78);c.index=i,o.push(c)})),this.existingCornLists=o}drawFarmer(){const{anims:e,physics:t}=this,s=t.add.sprite(72,96,"farmer",0);this.farmer=s,s.setCollideWorldBounds(!0),e.create({key:"farmer-front",frames:e.generateFrameNumbers("farmer",{start:0,end:3}),frameRate:10,repeat:-1}),e.create({key:"farmer-back",frames:e.generateFrameNumbers("farmer",{start:4,end:7}),frameRate:10,repeat:-1}),e.create({key:"farmer-left",frames:e.generateFrameNumbers("farmer",{start:8,end:11}),frameRate:10,repeat:-1}),e.create({key:"farmer-right",frames:e.generateFrameNumbers("farmer",{start:12,end:15}),frameRate:10,repeat:-1})}drawPom(){const{anims:e,physics:t}=this,{world:{bounds:{centerY:s}}}=t,r=t.add.sprite(720,s+180,"pompom",2);this.pom=r,r.setCollideWorldBounds(!0),e.create({key:"pompom-front",frames:e.generateFrameNumbers("pompom",{start:2,end:3}),frameRate:10,repeat:-1}),e.create({key:"pompom-back",frames:e.generateFrameNumbers("pompom",{start:7,end:8}),frameRate:10,repeat:-1}),e.create({key:"pompom-left",frames:e.generateFrameNumbers("pompom",{start:0,end:1}),frameRate:10,repeat:-1}),e.create({key:"pompom-right",frames:e.generateFrameNumbers("pompom",{start:4,end:5}),frameRate:10,repeat:-1})}drawHealthBar(e=this.currentLevel-1){const{physics:t}=this,{world:{bounds:{width:s}}}=t;this.add.sprite(s-136,0,"healthbar",3-e).setOrigin(0,0).setScale(.75)}drawEatenCorn(){const{physics:e,eatenCornLists:t}=this,{world:{bounds:{width:s}}}=e;t.forEach(((e,t)=>{this.add.image(s-18,248+36*t,"corn").setOrigin(0,0).setScale(.36)}))}drawCarryingCorn(e=!0){const{pom:t,currentCarryingCorn:s}=this,{x:r,y:a}=t,n=a+18;if(s)return s.x=r,void(s.y=n);if(e)return;const o=this.add.image(r,n,"corn");o.setScale(.5).setAngle(90),this.currentCarryingCorn=o}loadMusicResource(e=!0){this.backgroundSound=this.sound.add("background-music",{loop:!0}),this.alarmSound=this.sound.add("alarm",{loop:!0}),this.pickSound=this.sound.add("pick",{loop:!1}),this.caughtSound=this.sound.add("caught",{loop:!1}),this.winSound=this.sound.add("win",{loop:!1}),e&&this.backgroundSound.play()}checkCollision(){const{scene:e,sound:t,physics:s,farmer:r,fenceGroup:a,brownland:n,pom:o,existingCornLists:i,backgroundSound:d,alarmSound:c,pickSound:h,caughtSound:l,winSound:p}=this;s.add.overlap(o,n,(()=>{c.isPlaying||(c.play(),d.stop()),this.hasEnteredBrownland=!0})),s.add.overlap(o,i,((e,t)=>{const{currentCarryingIndex:s,currentCarryingCorn:r}=this;~s||r||(h.play(),t.destroy(),this.drawCarryingCorn(!1),this.currentCarryingIndex=t.index)})),s.add.collider(o,a,(()=>{const{currentCarryingIndex:s,currentCarryingCorn:r,eatenCornLists:a,nextSceneName:n,cornTotalCount:o}=this;~s&&r&&(r.destroy(),this.currentCarryingCorn=null,a.push(s),a.length===o?n?e.stop().start(n,{isPassed:!0}):(this.drawHealthBar(),setTimeout((()=>{alert("Congratulations!"),t.stopAll(),e.stop().switch("Start")}),0),c.stop(),p.play()):e.restart({isPassed:!1}))})),s.add.overlap(o,r,(()=>{c.stop(),d.stop(),l.play(),alert("Pompom is caught!"),e.restart({isPassed:!1})}))}resetDataStatus(e=!0){const{sound:t,backgroundSound:s}=this;t.stopAll(),s.play(),this.spaceKeyPressed=!1,this.currentCarryingCorn=null,this.currentCarryingIndex=-1,this.hasEnteredBrownland=!1,e&&(this.eatenCornLists=[])}}class n extends a{constructor(){super("LevelOne"),this.nextSceneName="LevelTwo",this.currentLevel=1,this.pomSpeed=160,this.farmerSpeed=80,this.cornSoilGap=72,this.cornTotalCount=2,this.firstCornOffsetX=24}init(e={}){const{isPassed:t}=e;super.init(e),this.resetDataStatus(!1!==t),console.log("LevelOne inited")}create(){super.create(),console.log("LevelOne created")}}class o extends a{constructor(){super("LevelTwo"),this.nextSceneName="LevelThree",this.currentLevel=2,this.pomSpeed=160,this.farmerSpeed=320/3,this.cornSoilGap=48,this.cornTotalCount=3,this.firstCornOffsetX=-12}init(e={}){const{isPassed:t}=e;super.init(e),this.resetDataStatus(!1!==t),console.log("LevelTwo inited")}create(){super.create(),console.log("LevelTwo created")}}class i extends a{constructor(){super("LevelThree"),this.nextSceneName="",this.currentLevel=3,this.pomSpeed=160,this.farmerSpeed=1600/11,this.cornSoilGap=25,this.cornTotalCount=4,this.firstCornOffsetX=-28}init(e={}){const{isPassed:t}=e;super.init(e),this.resetDataStatus(!1!==t),console.log("LevelThree inited")}create(){super.create(),console.log("LevelThree created")}}class d extends e.Game{constructor(e){super(e),this.initialize()}initialize(){this.scene.add("PreloadResource",s,!0),this.scene.add("Start",r),this.scene.add("LevelOne",n),this.scene.add("LevelTwo",o),this.scene.add("LevelThree",i)}}new d(t);
