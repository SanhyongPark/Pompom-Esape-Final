import{p as e}from"./vendor.a50a6e37.js";!function(e=".",r="__import__"){try{self[r]=new Function("u","return import(u)")}catch(t){const a=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[r]=e=>new Promise(((t,n)=>{const i=new URL(e,a);if(self[r].moduleMap[i])return t(self[r].moduleMap[i]);const o=new Blob([`import * as m from '${i}';`,`${r}.moduleMap['${i}']=m;`],{type:"text/javascript"}),d=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){n(new Error(`Failed to import: ${e}`)),s(d)},onload(){t(self[r].moduleMap[i]),s(d)}});document.head.appendChild(d)})),self[r].moduleMap={}}}("assets/");const r={title:"PomPom PK Farmer",type:e.AUTO,width:800,height:600,transparent:!0,disableContextMenu:!0,canvasStyle:"display: block; margin: 24px auto 0",physics:{default:"arcade",arcade:{debug:!0,debugShowBody:!0,debugShowStaticBody:!0,gravity:{x:0,y:0}}}};class t extends e.Scene{preload(){this.load.image("background","assets/background.png"),this.load.image("brownland","assets/brownland.png"),this.load.image("corn","assets/corn.png"),this.load.image("soil","assets/soil.png"),this.load.image("fence","assets/fence.png"),this.load.spritesheet("pompom","assets/pompom.png",{frameWidth:80,frameHeight:120}),this.load.spritesheet("farmer","assets/farmer.png",{frameWidth:84,frameHeight:98}),this.load.image("bar","assets/bar.png"),this.load.spritesheet("healthbar","assets/healthbar/healthbar.png",{frameWidth:160,frameHeight:80}),this.load.atlas("healthbar-json","assets/healthbar/healthbar.png","assets/healthbar/healthbar.json"),this.load.audio("background_music","assets/audio/background.ogg"),this.load.audio("pick","assets/audio/pick.mp3"),this.load.audio("caught","assets/audio/caught.mp3"),this.load.audio("alarm","assets/audio/alarm.wav"),this.load.audio("win","assets/audio/win.wav")}create(){this.scene.start("LevelOne")}}const a=[];class s extends e.Scene{constructor(){super(...arguments),this.nextSceneName="LevelOne",this.spaceKeyPressed=!1,this.currentCarryingCorn=null,this.currentCarryingIndex=-1,this.hasEnteredBrownland=!1,this.existingCornLists=[]}create(){const{scene:e,nextSceneName:r}=this;console.log(e.key,r,a),this.registerEvents(),this.drawBackgroundAndBrownland(),this.drawSoilAndCron(),this.drawFarmer(),this.drawPom(),this.drawHealthBar(),this.checkCollision(),this.background_music=this.sound.add("background_music",{loop:!0}),this.background_music.play(),this.pick=this.sound.add("pick",{loop:!1}),this.caught=this.sound.add("caught",{loop:!1}),this.alarm=this.sound.add("alarm",{loop:!1}),this.win=this.sound.add("win",{loop:!1}),window.scene=this}update(){const{pom:e,farmer:r,cursor:t,scene:a,physics:s,spaceKeyPressed:n,currentCarryingIndex:i,hasEnteredBrownland:o}=this;if(t.space.isDown){if(n)return;return this.spaceKeyPressed=!0,void(a.isPaused()?a.resume():a.pause())}t.up.isDown?(e.setVelocity(0,-160),e.anims.play("pompom-front",!0),this.drawCarryingCorn()):t.down.isDown?(e.setVelocity(0,160),e.anims.play("pompom-back",!0),this.drawCarryingCorn()):t.left.isDown?(e.setVelocity(-160,0),e.anims.play("pompom-left",!0),this.drawCarryingCorn()):t.right.isDown?(e.setVelocity(160,0),e.anims.play("pompom-right",!0),this.drawCarryingCorn()):(e.setVelocity(0,0),e.anims.pause()),(~i||o)&&s.moveToObject(r,e,80)}registerEvents(){const{input:{keyboard:e}}=this,r=e.createCursorKeys();this.cursor=r}drawBackgroundAndBrownland(){this.drawBackground(),this.drawBrownlandAndFence()}drawBackground(){const{physics:e}=this,{world:{bounds:{centerX:r,centerY:t}}}=e;this.add.image(r,t,"background")}drawBrownlandAndFence(){const{physics:e}=this,{world:{bounds:{width:r,centerX:t,centerY:a}}}=e,s=e.add.image(t,a+0,"brownland"),n=e.add.staticGroup();n.create(r-25,a+0,"fence").setOrigin(0,.5).refreshBody(),this.brownland=s,this.fenceGroup=n}drawSoilAndCron(){const{physics:e}=this,{world:{bounds:{centerY:r}}}=e,t=[];Array.from({length:3}).forEach(((s,n)=>{const i=179+157*n;if(this.add.image(i,r+0,"soil").setOrigin(0,.5),~a.indexOf(n))return;const o=e.add.image(i+45,r+0,"corn").setOrigin(0,.5);o.index=n,t.push(o)})),this.existingCornLists=t}drawFarmer(){const{anims:e,physics:r}=this,t=r.add.sprite(72,96,"farmer",0);this.farmer=t,t.setCollideWorldBounds(!0),e.create({key:"farmer-front",frames:e.generateFrameNumbers("farmer",{start:0,end:3}),frameRate:10,repeat:-1}),e.create({key:"farmer-back",frames:e.generateFrameNumbers("farmer",{start:4,end:7}),frameRate:10,repeat:-1}),e.create({key:"farmer-left",frames:e.generateFrameNumbers("farmer",{start:8,end:11}),frameRate:10,repeat:-1}),e.create({key:"farmer-right",frames:e.generateFrameNumbers("farmer",{start:12,end:15}),frameRate:10,repeat:-1})}drawPom(){const{anims:e,physics:r}=this,{world:{bounds:{centerY:t}}}=r,a=r.add.sprite(720,t+180,"pompom",2);this.pom=a,a.setCollideWorldBounds(!0),e.create({key:"pompom-front",frames:e.generateFrameNumbers("pompom",{start:2,end:3}),frameRate:10,repeat:-1}),e.create({key:"pompom-back",frames:e.generateFrameNumbers("pompom",{start:7,end:8}),frameRate:10,repeat:-1}),e.create({key:"pompom-left",frames:e.generateFrameNumbers("pompom",{start:0,end:1}),frameRate:10,repeat:-1}),e.create({key:"pompom-right",frames:e.generateFrameNumbers("pompom",{start:4,end:5}),frameRate:10,repeat:-1})}drawHealthBar(e=a.length){const{physics:r}=this,{world:{bounds:{width:t}}}=r;this.add.sprite(t-136,0,"healthbar",3-e).setOrigin(0,0).setScale(.75)}drawEatenCorn(){const{physics:e}=this,{world:{bounds:{width:r}}}=e;a.forEach(((e,t)=>{this.add.image(r-18,248+36*t,"corn").setOrigin(0,0).setScale(.36)}))}drawCarryingCorn(e=!0){const{pom:r,currentCarryingCorn:t}=this,{x:a,y:s}=r,n=s+18;if(t)return t.x=a,void(t.y=n);if(e)return;const i=this.add.image(a,n,"corn");i.setScale(.5).setAngle(90),this.currentCarryingCorn=i}checkCollision(){const{scene:e,physics:r,farmer:t,fenceGroup:s,brownland:n,pom:i,existingCornLists:o}=this;r.add.overlap(i,n,(()=>{this.alarm.isPlaying||(this.alarm=this.sound.add("alarm",{volume:.25}),this.alarm.play(),this.background_music.pause()),this.hasEnteredBrownland=!0})),r.add.overlap(i,o,((e,r)=>{const{currentCarryingIndex:t,currentCarryingCorn:a}=this;this.pick.play(),~t||a||(r.destroy(),this.drawCarryingCorn(!1),this.currentCarryingIndex=r.index)})),r.add.collider(i,s,(()=>{const{currentCarryingIndex:r,currentCarryingCorn:t,nextSceneName:s}=this;~r&&t&&(t.destroy(),this.currentCarryingCorn=null,a.push(r),s?e.stop().start(s):(this.drawHealthBar(),setTimeout((()=>{alert("GameOver")}),0),this.alarm.pause(),this.win.play()))})),r.add.overlap(i,t,(()=>{this.alarm.pause(),this.background_music.pause(),this.caught.play(),alert("Pompom is caught!"),e.restart()}))}resetDataStatus(){this.spaceKeyPressed=!1,this.currentCarryingCorn=null,this.currentCarryingIndex=-1,this.hasEnteredBrownland=!1,this.game.sound.stopAll()}}class n extends s{constructor(){super("LevelOne"),this.nextSceneName="LevelTwo"}init(){a.length=0,this.resetDataStatus(),console.log("LevelOne inited")}create(){super.create(),console.log("LevelOne created")}}class i extends s{constructor(){super("LevelTwo"),this.nextSceneName="LevelThree"}init(){this.resetDataStatus(),console.log("LevelTwo inited")}create(){super.create(),console.log("LevelTwo created")}}class o extends s{constructor(){super("LevelThree"),this.nextSceneName=""}init(){this.resetDataStatus(),console.log("LevelThree inited")}create(){super.create(),console.log("LevelThree created")}}class d extends e.Game{constructor(e){super(e),this.initialize()}initialize(){this.scene.add("PreloadResource",t,!0),this.scene.add("LevelOne",n),this.scene.add("LevelTwo",i),this.scene.add("LevelThree",o)}}const c=new d(r);window.mainGame=c;
